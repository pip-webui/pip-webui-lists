!function(){"use strict";angular.module("pipLists",["pipFocused","pipSelected","pipInfiniteScroll","pipDraggable","pipTagList"])}(),function(){"use strict";var e=angular.module("pipDraggable",["pipUtils"]);e.service("pipDraggable",function(){var e=this;e.inputEvent=function(e){return angular.isDefined(e.touches)?e.touches[0]:angular.isDefined(e.originalEvent)&&angular.isDefined(e.originalEvent.touches)?e.originalEvent.touches[0]:e}}),e.directive("pipDrag",["$rootScope","$parse","$document","$window","pipDraggable","pipUtils",function(e,t,n,i,o,r){return{restrict:"A",link:function(a,l,p){function c(){x.left=l.css("css"),x.top=l.css("top"),x.position=l.css("position"),x.width=l.css("width")}a.value=p.ngDrag;var u,s,d,f,g,m,v,$,h=50,D=!1,E="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,S="touchstart mousedown",w="touchmove mousemove",C="touchend mouseup",b=a.$id,y=null,O=null,T=!1,R=null,x={},_=t(p.pipDragStart)||null,A=t(p.pipDragStop)||null,I=t(p.pipDragSuccess)||null,Y=!!angular.isDefined(p.allowTransform)&&a.$eval(p.allowTransform),k=t(p.pipDragData),L=r.toBoolean(p.pipVerticalScroll)||!0,W=r.toBoolean(p.pipHorizontalScroll)||!0,H=parseFloat(p.pipActivationDistance)||75,B=parseFloat(p.pipScrollDistance)||50,K=!1,F=angular.element(window),N=t(p.pipScrollContainer),P=angular.noop,U=function(){if(l.attr("pip-draggable","false"),l[0].querySelectorAll)var e=angular.element(l[0].querySelectorAll("[pip-drag-handle]"));else var e=l.find("[pip-drag-handle]");e.length&&($=e),X(!0),F=K?angular.element($element.parent()):p.pipScrollContainer?angular.element(N(a)):angular.element(window)},X=function(e){e&&(a.$on("$destroy",M),a.$watch(p.pipDrag,z),a.$watch(p.pipCenterAnchor,G),$?$.on(S,V):l.on(S,V),E||"img"!=l[0].nodeName.toLowerCase()||l.on("mousedown",function(){return!1}))},M=function(e){X(!1)},z=function(e,t){T=e},G=function(e,t){angular.isDefined(e)&&(D=e||"true")},q=function(e){return angular.isDefined(angular.element(e.target).attr("pip-cancel-drag"))},V=function(e){T&&(q(e)||"mousedown"==e.type&&0!=e.button||(c(),E?(j(),R=setTimeout(function(){j(),J(e)},h),n.on(w,j),n.on(C,j)):J(e)))},j=function(){clearTimeout(R),n.off(w,j),n.off(C,j)},J=function(t){T&&(t.preventDefault(),u=l[0].getBoundingClientRect(),O=Y?u:{left:document.body.scrollLeft,top:document.body.scrollTop},l.centerX=l[0].offsetWidth/2,l.centerY=l[0].offsetHeight/2,s=o.inputEvent(t).pageX,d=o.inputEvent(t).pageY,m=s-u.left,v=d-u.top,D?(f=s-l.centerX-i.pageXOffset,g=d-l.centerY-i.pageYOffset):(f=s-m-i.pageXOffset,g=d-v-i.pageYOffset),n.on(w,Q),n.on(C,Z),P=e.$on("draggable:_triggerHandlerMove",function(e,t){Q(t)}))},Q=function(t){T&&(t.preventDefault(),l.hasClass("pip-dragging")||(y=k(a),l.addClass("pip-dragging"),e.$broadcast("draggable:start",{x:s,y:d,tx:f,ty:g,event:t,element:l,data:y}),_&&a.$apply(function(){_(a,{$data:y,$event:t})})),s=o.inputEvent(t).pageX,d=o.inputEvent(t).pageY,(W||L)&&ie(),D?(f=s-l.centerX-O.left,g=d-l.centerY-O.top):(f=s-m-O.left,g=d-v-O.top),ne(f,g),e.$broadcast("draggable:move",{x:s,y:d,tx:f,ty:g,event:t,element:l,data:y,uid:b,dragOffset:O}))},Z=function(t){T&&(t.preventDefault(),e.$broadcast("draggable:end",{x:s,y:d,tx:f,ty:g,event:t,element:l,data:y,callback:ee,uid:b}),l.removeClass("pip-dragging"),l.parent().find(".pip-drag-enter").removeClass("pip-drag-enter"),te(),n.off(w,Q),n.off(C,Z),A&&a.$apply(function(){A(a,{$data:y,$event:t})}),P())},ee=function(e){I&&a.$apply(function(){I(a,{$data:y,$event:e})})},te=function(){Y?l.css({transform:"","z-index":"","-webkit-transform":"","-ms-transform":""}):l.css({position:x.position,top:x.top,left:x.left,"z-index":"",width:x.width})},ne=function(e,t){var n=l.css("width");Y?l.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","z-index":99999,"-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+e+", "+t+")"}):l.css({left:e+"px",top:t+"px",position:"fixed","z-index":100,width:n})},ie=function(){var e=0,t=0,n=function(e){return e.offset()||{left:0,top:0}};if(W){var i=n(F).left,o=F.innerWidth(),r=i+o;s-i<H?e=-B:r-s<H&&(e=B)}if(L){var a=n(F).top,l=F.innerHeight(),p=a+l;d-a<H?t=-B+30:p-d<H&&(t=B-30)}if(0!==e||0!==t){var c=F.scrollLeft(),u=F.scrollTop();F.scrollLeft(c+e),F.scrollTop(u+t)}};U()}}}]),e.directive("pipDrop",["$parse","$timeout","$window","$document","pipDraggable",function(e,t,n,i,o){return{restrict:"A",link:function(n,o,r){n.value=r.pipDrop,n.isTouching=!1;var a=null,l=n.$id,p=!1,c=e(r.pipDropSuccess),u=e(r.pipDragStart),s=e(r.pipDragStop),d=e(r.pipDragMove),f=function(){g(!0)},g=function(e){e&&(n.$watch(r.pipDrop,v),n.$on("$destroy",m),n.$on("draggable:start",$),n.$on("draggable:move",h),n.$on("draggable:end",D))},m=function(e){g(!1)},v=function(e,t){p=e},$=function(e,i){p&&(E(i.x,i.y,i.element),r.pipDragStart&&t(function(){u(n,{$data:i.data,$event:i})}))},h=function(e,i){p&&(E(i.x,i.y,i.element),r.pipDragMove&&t(function(){d(n,{$data:i.data,$event:i})}))},D=function(e,i){return p&&l!==i.uid?(E(i.x,i.y,i.element)&&(i.callback&&i.callback(i),r.pipDropSuccess&&t(function(){c(n,{$data:i.data,$event:i,$target:n.$eval(n.value)})})),r.pipDragStop&&t(function(){s(n,{$data:i.data,$event:i})}),void S(!1,i.element)):void S(!1,i.element)},E=function(e,t,i){var r=w(e,t);return n.isTouching=r,r&&(a=o),S(r,i),r},S=function(e,t){e?(o.addClass("pip-drag-enter"),t.addClass("pip-drag-over")):a==o&&(a=null,o.removeClass("pip-drag-enter"),t.removeClass("pip-drag-over"))},w=function(e,t){var n=o[0].getBoundingClientRect();return e-=i[0].body.scrollLeft+i[0].documentElement.scrollLeft,t-=i[0].body.scrollTop+i[0].documentElement.scrollTop,e>=n.left&&e<=n.right&&t<=n.bottom&&t>=n.top};f()}}}]),e.directive("pipPreventDrag",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var i=function(){t.attr("pip-draggable","false"),o(!0)},o=function(e){e&&t.on("mousedown touchstart touchmove touchend touchcancel",r)},r=function(e){var t=e.originalEvent;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};i()}}}]),e.directive("pipCancelDrag",function(){return{restrict:"A",link:function(e,t,n){t.find("*").attr("pip-cancel-drag","pip-cancel-drag")}}})}(),function(){"use strict";var e=angular.module("pipFocused",[]);e.directive("pipFocused",["$timeout","$mdConstant",function(e,t){return{require:"?ngModel",link:function(n,i,o){function r(){var e=c?".pip-focusable":".pip-focusable:visible";l=i.find(e),p=l.length,l.on("focus",function(){i.addClass("pip-focused-container"),$(this).addClass("md-focused")}).on("focusout",function(){i.removeClass("pip-focused-container")})}function a(e){var n=e.which||e.keyCode;if(n==t.KEY_CODE.LEFT_ARROW||n==t.KEY_CODE.UP_ARROW||n==t.KEY_CODE.RIGHT_ARROW||n==t.KEY_CODE.DOWN_ARROW){e.preventDefault();var i=n==t.KEY_CODE.RIGHT_ARROW||n==t.KEY_CODE.DOWN_ARROW?1:-1,o=l.index(l.filter(".md-focused"))+i;o>=0&&o<p&&l[o].focus()}}var l,p,c=o.pipWithHidden;e(r),i.on("keydown",a),n.$watch(o.ngModel,function(){e(r)},!0)}}}])}(),function(){"use strict";var e=angular.module("pipInfiniteScroll",[]);e.directive("pipInfiniteScroll",["$rootScope","$window","$interval","$parse",function(e,t,n,i){var o=500;return{scope:{pipInfiniteScroll:"&",pipScrollContainer:"=",pipScrollDistance:"=",pipScrollDisabled:"=",pipScrollUseDocumentBottom:"=",pipScrollListenForEvent:"@"},link:function(i,r,a){function l(e){return e=e[0]||e,isNaN(e.offsetHeight)?e.document.documentElement.clientHeight:e.offsetHeight}function p(e){if(e[0].getBoundingClientRect&&!e.css("none"))return e[0].getBoundingClientRect().top+c(e)}function c(e){return e=e[0]||e,isNaN(window.pageYOffset)?e.document.documentElement.scrollTop:e.ownerDocument.defaultView.pageYOffset}function u(e){return h=parseFloat(e)||0}function s(e){if(D=!e,D&&v)return v=!1,C()}function d(e){return S=e}function f(e){if(null!=m&&m.unbind("scroll",C),m=e,null!=e)return m.bind("scroll",C)}function g(e){if(null!=e&&0!==e.length){if(e instanceof HTMLElement?e=angular.element(e):"function"==typeof e.append?e=angular.element(e[e.length-1]):"string"==typeof e&&(e=r.parents().find(e)),null!=e&&(!Array.isArray(e)||Array.isArray(e)&&e.length>0))return f(e);throw new Error("Invalid pip-scroll-container attribute.")}}var m,v=null,$=!0,h=null,D=null,E=null,S=!1,w=angular.element(t),C=function(){var t,n,o,a,u;return m===w?(t=l(m)+c(m[0].document.documentElement),o=p(r)+l(r)):(t=l(m),n=0,void 0!==p(m)&&(n=p(m)),o=p(r)-n+l(r)),S&&(o=l((r[0].ownerDocument||r[0].document).documentElement)),a=o-t,u=a<=l(m)*h+1,u?(v=!0,D?i.$$phase||e.$$phase?i.pipInfiniteScroll():i.$apply(i.pipInfiniteScroll):void 0):v=!1};return null!=o&&(C=_.throttle(C,o)),i.$on("$destroy",function(){if(m.unbind("scroll",C),null!=E)return E(),E=null}),i.$watch("pipScrollDistance",u),u(i.pipScrollDistance),i.$watch("pipScrollDisabled",s),s(i.pipScrollDisabled),i.$watch("pipScrollUseDocumentBottom",d),d(i.pipScrollUseDocumentBottom),f(w),i.pipScrollListenForEvent&&(E=e.$on(i.pipScrollListenForEvent,C)),i.$watch("pipScrollContainer",function(e){e!==m&&g(e)}),g(i.pipScrollContainer||[]),null!=a.pipScrollParent&&f(angular.element(r.parent())),null!=a.pipScrolImmediateCheck&&($=i.$eval(a.pipScrolImmediateCheck)),n(function(){if($)return C()},0,1)}}}])}(),function(){"use strict";var e=angular.module("pipSelected",["pipUtils"]);e.directive("pipSelected",["$parse","pipUtils","$mdConstant","$timeout",function(e,t,n,i){return{restrict:"A",scope:!1,link:function(i,o,r){function a(e){var t=e.itemIndex,n=e.itemId,i=e.items||o.find(h+v),r=i.length,a=function(){return e.item?e.item:(void 0===t&&t===-1&&(t=i.index(i.filter("[pip-id="+n+"]"))),t>=0&&t<r?i[t]:void 0)}(),c=e.raiseEvent;a&&(o.find(h).removeClass("selected md-focused"),a=angular.element(a).addClass("selected md-focused").focus(),m||p(a),c&&l(i))}function l(e){function t(){var t=angular.element(e[D]),r=t.attr("pip-id");u&&u(i,D),d&&d(i,r),f&&f(i,{$event:{target:o,item:t,index:D,id:r,newIndex:D,oldIndex:n}})}var n=D;D=-1;for(var r=0;r<e.length;r++)if($(e[r]).hasClass("selected")){D=r;break}n!=D&&D!==-1&&i.$apply(t)}function p(e){if(!m){var t=o.offset().top,n=o.height(),i=t+n,r=e.offset().top,a=e.outerHeight(!0),l=r+a,p=o.scrollTop();t>r?o.scrollTop(p+r-t):i<l&&o.scrollTop(p+l-i)}}var c=r.pipSelected?e(r.pipSelected):null,u=c?c.assign:null,s=r.pipSelectedId?e(r.pipSelectedId):null,d=s?s.assign:null,f=r.pipSelect?e(r.pipSelect):null,g=r.pipEnterSpacePress?e(r.pipEnterSpacePress):null,m=t.toBoolean(r.pipNoScroll),v=t.toBoolean(r.pipSkipHidden)?":visible":"",h=t.toBoolean(r.pipTreeList)?".pip-selectable-tree":".pip-selectable",D=c(i),E=o.attr("tabindex"),S=r.pipSelectedWatch;o.attr("tabindex",E||0),t.toBoolean(r.pipTreeList)?i.$watch(s,function(e){setTimeout(function(){a({itemId:e,raiseEvent:!0})},0)}):i.$watch(c,function(e){a({itemIndex:e})}),S&&i.$watch(S,function(){setTimeout(function(){D=c(i),a({itemIndex:D})},100)}),a({itemIndex:D,items:o.find(h)}),o.on("click touchstart",h,function(e){a({item:e.currentTarget,raiseEvent:!0})}),o.on("keydown",function(e){var t=e.which||e.keyCode;if(t==n.KEY_CODE.ENTER||t==n.KEY_CODE.SPACE)e.preventDefault(),e.stopPropagation(),g&&g(i,{$event:{target:o,index:D,item:o.find(".selected")}});else if(t==n.KEY_CODE.LEFT_ARROW||t==n.KEY_CODE.RIGHT_ARROW||t==n.KEY_CODE.UP_ARROW||t==n.KEY_CODE.DOWN_ARROW){e.preventDefault(),e.stopPropagation();var r=o.find(h+v),l=t==n.KEY_CODE.RIGHT_ARROW||t==n.KEY_CODE.DOWN_ARROW?1:-1,p=D+l;a({itemIndex:p,items:r,raiseEvent:!0})}}),o.on("focusin",function(e){var t,n=o.find(h+".selected");n.addClass("md-focused"),0===n.length&&(D=c(i),t=o.find(h+v),a({itemIndex:D||0,items:t,raiseEvent:!0}))}),o.on("focusout",function(e){o.find(h+".md-focused"+v).removeClass("md-focused")})}}}])}(),function(e){"use strict";var t=e.module("pipTagList",[]);t.directive("pipTagList",["$parse",function(e){return{restrict:"EA",scope:{pipTags:"=",pipType:"=",pipTypeLocal:"="},templateUrl:"tags/tag_list.html",controller:["$scope","$element","$attrs",function(t,n,i){function o(e){return null!=e&&(!!e&&(e=e.toString().toLowerCase(),"1"==e||"true"==e))}var r;r=e(i.pipTags),n.css("display","block"),t.tags=r(t),o(i.pipRebind)&&t.$watch(r,function(){t.tags=r(t)}),n.addClass("pip-tag-list")}]}}])}(window.angular);